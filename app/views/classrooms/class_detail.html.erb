<div class="admin-block">
  <h1>
    ห้องเรียน - <%= params[:id] %>
    <%= link_to 'กลับ', classrooms_path , class: 'btn-bfr'%>
    <a id="update-stage" class="btn-ner"><%= @inspect_class_button %></a>
    <!-- <%= link_to 'เพิ่มนักเรียนใหม่', new_student_path , class: 'btn-ner'%> -->
    <span class="class-period">
      ปัจุบันเรียนครั้งที่
      <select class="" name="" id="current-class">
        <% @periods.times do |p| %>
          <option
            value="<%= p + 1 %>"
            <% if (p+1) == @current_period  %>selected<% end %>
            >
            <%= p + 1 %>
          </option>
        <% end %>
      </select>
    </span>
  </h1>

  <table>
    <thead>
      <tr>
        <th>นักเรียน</th>
        <th>ชั้นปี</th>
        <th>โรงเรียน</th>
        <!-- <th>คอมเม้นท์</th> -->
        <th class="center-div" >คะเเนนรวม</th>
        <% @periods.times do |i| %>
          <th
            class=" center-div <% if (i+1) == @current_period %>yellow-gadget<% end %>"
            >
            <%= i + 1%>
          </th>
        <% end %>
        <th class="center-div" colspan="2">คำสั่ง</th>
      </tr>
    </thead>

    <tbody>
      <% @seats.each do |seat| %>
        <% seat_detail = Seat.seat_detail(seat)%>
        <form class="" action="<%= home_update_score_path %>" method="get">
          <input type="hidden" name="classroom" value="<%= seat[:classroom] %>">
          <input type="hidden" name="student" value="<%= seat[:student] %>">
          <input type="hidden" name="seat_id" value="<%= seat[:id] %>">
          <tr>
            <td><%= seat_detail[:name] %></td>
            <td><%= seat_detail[:grade] %></td>
            <td><%= seat_detail[:school] %></td>
            <!-- <td style="max-width:90px; padding-right: 8px;">
              <input type="text" name="comment" value="<%= seat_detail[:comment] %>" style="width:100%">
            </td> -->
            <td>
              <div class="sc-tb">สอบ (<%= seat_detail[:total] %>)</div>
              <div class="ma-tb">ตั้งใจ (<%= seat_detail[:total_mental] %>)</div>
            </td>
            <% seat_detail[:score][:scoring].each_with_index do |score,idx|%>
              <td
                class="scoring <% if (idx+1) == @current_period %>yellow-gadget<% end %>"
                >
                <input class="first" type="text" name="score[<%= idx.to_i %>]"  value="<%= seat_detail[:score][:scoring][idx] %>" style="width:100%"> <br>
                <input type="text" name="mental[<%= idx.to_i %>]" value="<%= seat_detail[:score][:mental][idx + 1]%>"  style="width:100%">
                <!-- <select class="select-boxing" name="score[<%= idx.to_i %>]">
                  <option value="-"> - </option>
                  <% 11.times do |t| %>
                    <option
                      value="<%= t %>"
                      <% if t == (seat_detail[:score][:scoring][idx].floor.to_i rescue '-') %> selected <% end %>
                      >
                      <%= t %>
                    </option>
                  <% end %>
                </select> <br>
                <select class="select-boxing" name="mental[<%= idx.to_i %>]">
                  <option value="-"> - </option>
                  <% 11.times do |t| %>
                    <option
                      value="<%= t %>"
                      <% if t == (seat_detail[:score][:mental][idx + 1].floor.to_i rescue '-') %> selected <% end %>
                      >
                      <%= t %>
                    </option>
                  <% end %>
                </select> -->
              </td>
            <% end %>
            <td><input type="submit" name="" value="อัพเดท"></td>
            <td><%= link_to 'ลบนักเรียน', seat, method: :delete, data: { confirm: 'Are you sure?' } %></td>
          </tr>
        </form>
      <% end %>
    </tbody>
  </table>

  <p id="notice"><%= notice %></p>

</div>

<!-- toggle change class -->
<script type="text/javascript">
  $( document ).ready(function() {
    // alert('ready');
    $('#current-class').on('change',function(){
      var current = $('#current-class').val();
      // alert(current);
      window.location.href = '/home/edit_current?spec=<%= params[:id] %>&current=' + current
    });

    $( "#update-stage" ).on( "click", function() {
      alert("update score ครั้งที่ <%= @current_period %>");
      collection =
    });

  });
</script>
